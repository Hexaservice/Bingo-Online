<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cartón de Bingo</title>
  <style>
      body {
          font-family: Arial, sans-serif;
          text-align: center;
          background: url('https://source.unsplash.com/1600x900/?bingo,game') no-repeat center center fixed;
          background-size: cover;
      }
      h2 {
          font-size: 2.5rem;
          color: #ffcc00;
          text-shadow: 3px 3px 6px #000;
      }
      table {
          margin: 20px auto;
          border-collapse: collapse;
          background: rgba(255, 255, 255, 0.8);
          border-radius: 10px;
          overflow: hidden;
      }
      th {
          font-size: 2rem;
          color: #ff6600;
          text-shadow: 2px 2px 4px #000;
      }
      th, td {
          border: 2px solid #ff6600;
          width: 60px;
          height: 60px;
          text-align: center;
      }
      select {
          width: 100%;
          font-size: 2rem;
          font-weight: bold;
          padding: 5px;
          text-align: center;
          border: none;
          background: transparent;
          outline: none;
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
      }
      .free {
          background-color: #ffcc00;
          font-weight: bold;
      }
      button {
          padding: 10px 20px;
          font-size: 18px;
          background: #ff6600;
          color: white;
          border: none;
          border-radius: 5px;
          cursor: pointer;
      }
      button:hover {
          background: #cc5500;
      }
      @media (max-width: 600px) {
          table {
              width: 90%;
          }
          th, td {
              width: 50px;
              height: 50px;
          }
          select {
              font-size: 1.5rem;
          }
      }
  </style>
</head>
<body>
  <h2>Cartón de Bingo</h2>
  <table>
      <thead>
          <tr>
              <th>B</th><th>I</th><th>N</th><th>G</th><th>O</th>
          </tr>
      </thead>
      <tbody id="bingo-board"></tbody>
  </table>
  <button onclick="enviarDatos()">Enviar Cartón</button>
  
  <script>
      const board = document.getElementById("bingo-board");
      const ranges = [[1, 15], [16, 30], [31, 45], [46, 60], [61, 75]];

      function createBoard() {
          for (let row = 0; row < 5; row++) {
              let tr = document.createElement("tr");
              for (let col = 0; col < 5; col++) {
                  let td = document.createElement("td");
                  if (row === 2 && col === 2) {
                      td.classList.add("free");
                      td.textContent = "★"; 
                  } else {
                      let select = document.createElement("select");
                      select.dataset.row = row;
                      select.dataset.col = col;
                      let defaultOption = document.createElement("option");
                      defaultOption.value = "";
                      defaultOption.textContent = "";
                      defaultOption.selected = true;
                      select.appendChild(defaultOption);
                      for (let i = ranges[col][0]; i <= ranges[col][1]; i++) {
                          let option = document.createElement("option");
                          option.value = i;
                          option.textContent = i;
                          select.appendChild(option);
                      }
                      select.addEventListener("change", validateBoard);
                      td.appendChild(select);
                  }
                  tr.appendChild(td);
              }
              board.appendChild(tr);
          }
      }

      function validateBoard() {
          let columns = [[], [], [], [], []];
          let isValid = true;
          
          document.querySelectorAll("select").forEach(select => {
              let col = select.dataset.col;
              let value = select.value;
              
              if (value === "" || columns[col].includes(value)) {
                  select.style.border = "2px solid red";
                  isValid = false;
              } else {
                  select.style.border = "none";
                  columns[col].push(value);
              }
          });
          return isValid;
      }

      async function enviarDatos() {
          if (!validateBoard()) {
              alert("Corrige los errores antes de enviar. Asegúrate de seleccionar todos los valores y no repetir valores en las columnas.");
              return;
          }
          
          let data = [[], [], [], [], []];
          document.querySelectorAll("select").forEach(select => {
              let row = select.dataset.row;
              let col = select.dataset.col;
              data[row][col] = select.value || "";
          });

          let url = "https://script.google.com/macros/s/AKfycbwHECPJbnC4cvLlEiRL5h-DTe20AhtY-CGNPFsmU-hAtGgit8JogeZ-nMQ9SdkB5uSy9g/exec";

          try {
              let response = await fetch(url, {
                  method: "POST",
                  mode: "cors", // Modo CORS explícito
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify(data)
              });
              // Se asume que el servidor responde con JSON
              let result = await response.json();
              alert("Respuesta del servidor: " + JSON.stringify(result));
          } catch (error) {
              alert("Error al enviar los datos: " + error.message);
          }
      }

      createBoard();
  </script>
</body>
</html>




