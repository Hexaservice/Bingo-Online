<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cartón de Bingo</title>
  <style>
      body {
          font-family: Arial, sans-serif;
          text-align: center;
          background: url('https://source.unsplash.com/1600x900/?bingo,game') no-repeat center center fixed;
          background-size: cover;
      }
      h2 {
          font-size: 2.5rem;
          color: #ffcc00;
          text-shadow: 3px 3px 6px #000;
      }
      table {
          margin: 20px auto;
          border-collapse: collapse;
          background: rgba(255, 255, 255, 0.8);
          border-radius: 10px;
          overflow: hidden;
      }
      th {
          font-size: 2rem;
          color: #ff6600;
          text-shadow: 2px 2px 4px #000;
      }
      th, td {
          border: 2px solid #ff6600;
          width: 60px;
          height: 60px;
          text-align: center;
      }
      select {
          width: 100%;
          font-size: 2rem;
          font-weight: bold;
          padding: 5px;
          text-align: center;
          border: none;
          background: transparent;
          outline: none;
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
      }
      .free {
          background-color: #ffcc00;
          font-weight: bold;
      }
      button {
          padding: 10px 20px;
          font-size: 18px;
          background: #ff6600;
          color: white;
          border: none;
          border-radius: 5px;
          cursor: pointer;
      }
      button:hover {
          background: #cc5500;
      }
      @media (max-width: 600px) {
          table {
              width: 90%;
          }
          th, td {
              width: 50px;
              height: 50px;
          }
          select {
              font-size: 1.5rem;
          }
      }
  </style>
</head>
<body>
  <h2>Cartón de Bingo</h2>
  <table>
      <thead>
          <tr>
              <th>B</th><th>I</th><th>N</th><th>G</th><th>O</th>
          </tr>
      </thead>
      <tbody id="bingo-board"></tbody>
  </table>
  <button id="enviar-btn">Enviar Cartón</button>

  <!-- Importar el SDK modular de Firebase -->
  <script type="module">
    // Importar funciones necesarias de Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-app.js";
    import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-database.js";

    // Configuración de Firebase (reemplaza con tus datos)
    const firebaseConfig = {
      apiKey: "AIzaSyBztIl46s-vOOxrUVDilJNSN6zuzldeUWI",
      authDomain: "bingo-online-231fd.firebaseapp.com",
      databaseURL: "https://bingo-online-231fd-default-rtdb.firebaseio.com",
      projectId: "bingo-online-231fd",
      storageBucket: "bingo-online-231fd.firebasestorage.app",
      messagingSenderId: "455917034653",
      appId: "1:455917034653:web:ef3f7a1d14be86a1580874"
    };

    // Inicializar Firebase y la base de datos
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    // Función para enviar datos a Firebase
    async function enviarDatosAFirebase(data) {
      try {
        // Se crea un nodo único bajo "bingo"
        const dbRef = ref(database, 'bingo');
        const newEntryRef = push(dbRef);
        await set(newEntryRef, {
          timestamp: Date.now(),
          data: data
        });
        alert("Datos enviados correctamente a Firebase.");
      } catch (error) {
        alert("Error al enviar a Firebase: " + error.message);
      }
    }

    // Variables y funciones para el tablero de bingo
    const board = document.getElementById("bingo-board");
    const ranges = [[1, 15], [16, 30], [31, 45], [46, 60], [61, 75]];

    function createBoard() {
      for (let row = 0; row < 5; row++) {
        let tr = document.createElement("tr");
        for (let col = 0; col < 5; col++) {
          let td = document.createElement("td");
          if (row === 2 && col === 2) {
            td.classList.add("free");
            td.textContent = "★"; 
          } else {
            let select = document.createElement("select");
            select.dataset.row = row;
            select.dataset.col = col;
            let defaultOption = document.createElement("option");
            defaultOption.value = "";
            defaultOption.textContent = "";
            defaultOption.selected = true;
            select.appendChild(defaultOption);
            for (let i = ranges[col][0]; i <= ranges[col][1]; i++) {
              let option = document.createElement("option");
              option.value = i;
              option.textContent = i;
              select.appendChild(option);
            }
            select.addEventListener("change", validateBoard);
            td.appendChild(select);
          }
          tr.appendChild(td);
        }
        board.appendChild(tr);
      }
    }

    function validateBoard() {
      let columns = [[], [], [], [], []];
      let isValid = true;
      
      document.querySelectorAll("select").forEach(select => {
        let col = select.dataset.col;
        let value = select.value;
        
        if (value === "" || columns[col].includes(value)) {
          select.style.border = "2px solid red";
          isValid = false;
        } else {
          select.style.border = "none";
          columns[col].push(value);
        }
      });
      return isValid;
    }

    // Función que se ejecuta al presionar el botón "Enviar Cartón"
    async function enviarDatos() {
      if (!validateBoard()) {
        alert("Corrige los errores antes de enviar. Asegúrate de seleccionar todos los valores y no repetir valores en las columnas.");
        return;
      }
      
      // Recopilar los datos del tablero en un arreglo 2D
      let data = [[], [], [], [], []];
      document.querySelectorAll("select").forEach(select => {
        let row = select.dataset.row;
        let col = select.dataset.col;
        data[row][col] = select.value || "";
      });

      // Enviar los datos a Firebase
      await enviarDatosAFirebase(data);
    }

    // Agregar listener al botón para enviar datos
    document.getElementById("enviar-btn").addEventListener("click", enviarDatos);

    // Crear el tablero de bingo al cargar la página
    createBoard();
  </script>
</body>
</html>




